(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))n(c);new MutationObserver(c=>{for(const r of c)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function o(c){const r={};return c.integrity&&(r.integrity=c.integrity),c.referrerPolicy&&(r.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?r.credentials="include":c.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(c){if(c.ep)return;c.ep=!0;const r=o(c);fetch(c.href,r)}})();function v(){const e=document.getElementById("backToTopBtn");window.onscroll=function(){document.body.scrollTop>100||document.documentElement.scrollTop>100?e.style.display="block":e.style.display="none"},e.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})})}const f="http://localhost:3000";async function y(){try{return await(await fetch(`${f}/favorites`)).json()}catch(e){return console.error("Error:",e),null}}async function E(e){try{const t=await fetch(`${f}/favorites`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`Error: ${t.statusText}`);return await t.json()}catch(t){throw console.error("Post Data Error:",t),t}}async function C(e){try{const t=await fetch(`${f}/favorites/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Error: ${t.statusText}`);return await t.json()}catch(t){throw console.error("Post Data Error:",t),t}}const u="https://api.tcgdex.net/v2/en";async function $(e){try{return await(await fetch(`${u}/cards/${e}`)).json()}catch(t){return console.error("Error:",t),null}}async function q(){try{return await(await fetch(`${u}/series`)).json()}catch(e){return console.error("Error:",e),null}}async function g(e){try{return await(await fetch(`${u}/series/${e}`)).json()}catch(t){return console.error("Error:",t),null}}async function L(e="",t="",o="",n="",c=""){try{const r=`${u}/cards?id=like:${e}&name=like:${t}&category=like:${o}&rarity=like:${n}&sort:field=${c}`;return console.log(r),await(await fetch(r)).json()}catch(r){return console.error("Error:",r),null}}async function T(e){try{const t=`${u}/sets/${e}`;return(await(await fetch(t)).json()).cardCount.official}catch(t){return console.error("Error:",t),null}}async function b(e){try{const t=await T(e);console.log("Card Set:",e),console.log("Count:",t);const o=new Set,n=[];for(let a=1;a<t;a++){let s=`https://api.tcgdex.net/v2/en/cards/${e}-${a}`;["a1","sv-01","sv-02","sv-03","sv03.5"].indexOf(e.toLowerCase())!=-1?s=`https://api.tcgdex.net/v2/en/cards/${e}-${a.toString().padStart(3,"0")}`:["smp","bwp"].indexOf(e.toLowerCase())!=-1&&(s=`https://api.tcgdex.net/v2/en/cards/${e}-SM${a.toString().padStart(2,"0")}`),n.push(s)}const c=await Promise.all(n.map(a=>fetch(a)));for(const a of c){if(!a.ok){console.warn(`Error en la URL ${a.url}: ${a.statusText}`);continue}const s=await a.json();s.rarity&&o.add(s.rarity)}const r=[...o];return console.log("Rarities:",r),r}catch(t){return console.error("Error en getRarities:",t),[]}}v();let p="base";document.addEventListener("DOMContentLoaded",e=>{m("sectionCards"),q().then(o=>{I(o)}).catch(o=>console.log("Error: "+o)),document.querySelector(".buttonSearchByName").addEventListener("click",o=>{o.preventDefault(),o.stopPropagation(),h()})});function S(e,t=!1){const o=document.querySelector(".cardContainer .row");!e.length>0?o.innerHTML="<h2 class='errorFilters'>There are not cards that fit the filters</h2>":o.innerHTML="";const n=document.querySelector("#pokemonCardTemplate");e=e.filter(r=>r.image!=null),e.forEach(r=>{const a=n.cloneNode(!0).content,s=a.querySelector("img");s.src=`${r.image}/high.webp`,s.alt=r.id,a.querySelector(".starFavoriteButton").setAttribute("data-id",r.id),o.append(a)}),document.querySelectorAll(".starFavoriteButton").forEach(r=>{r.addEventListener("click",a=>{const s=r.getAttribute("data-id");$(s).then(i=>{E(i)}).catch(i=>console.log("Error: "+i))})})}function I(e){const t=document.querySelector(".dropdownSeries"),o=t.querySelector("#dropdownItemTemplate");e.forEach(n=>{const c=o.cloneNode(!0).content,r=c.querySelector("img"),a=c.querySelector(".nameItem");r.src=`${n.logo}.webp`,r.alt=`${n.name}`,a.textContent=`${n.name}`;const s=document.querySelector(".dropdownSeriesContainer .currentSeries");document.querySelector(".dropdownSeriesContainer .currentSeriesName");const i=c.querySelector("a");i.setAttribute("data-id",n.id),i.addEventListener("click",l=>{p=n.id,g(p).then(d=>{s.src=d.logo+".webp",s.alt=`${d.name}`,document.querySelector(".currentSet").setAttribute("src","img/logo-placeholder.png"),document.querySelector(".currentRarityName").textContent="",B(p)}).catch(d=>console.log("Error: "+d))}),t.append(c)})}function B(e){const t=document.querySelector(".dropdownSets");t.innerHTML="";const o=document.querySelector("#dropdownItemTemplate");g(e).then(n=>{n.sets.forEach(r=>{const a=o.cloneNode(!0).content,s=a.querySelector("img"),i=a.querySelector(".nameItem");s.src=`${r.logo}.webp`,s.alt=`${r.name}`,i.textContent=`${r.name}`;const l=a.querySelector("a");l.setAttribute("data-id",r.id);const d=document.querySelector(".dropdownSetsContainer .currentSet");l.addEventListener("click",P=>{r.id,d.src=r.logo+".webp",d.alt=`${r.name}`,d.parentNode.setAttribute("data-id",r.id),F(r.id),h()}),t.append(a)})}).catch(n=>console.log("Error: "+n))}function F(e){const t=document.querySelector(".dropdownRarity");t.innerHTML="";const o=document.querySelector("#dropdownItemRarityTemplate");b(e).then(n=>{n.forEach(c=>{const r=o.cloneNode(!0).content,a=r.querySelector(".rarityName");a.textContent=c;const s=r.querySelector("a"),i=document.querySelector(".currentRarityName");s.addEventListener("click",l=>{i.textContent=c,h()}),t.append(r)})}).catch(n=>console.log("Error: "+n))}function h(){let e=document.querySelector(".currentSet").parentNode.getAttribute("data-id"),t=document.querySelector(".inputSearchByName"),o=document.querySelector(".currentRarityName").textContent;e=e??"",L(e,t.value,"",o,"").then(n=>{console.log(n),S(n)}).catch(n=>console.log("Error: "+n))}function m(e){const t=document.querySelector("header");e=="sectionHero"?(t.classList.remove("d-none"),t.classList.add("d-none")):(t.classList.add("d-block"),t.classList.remove("d-none")),document.querySelectorAll(".pagina").forEach(c=>{c.classList.contains("d-block")&&c.classList.remove("d-block"),c.classList.add("d-none")});const n=document.querySelector(`#${e}`);n.classList.contains("d-none")&&n.classList.remove("d-none"),n.classList.add("d-block")}const A=document.querySelectorAll(".changeToSectionHero");A.forEach(e=>e.addEventListener("click",t=>m("sectionHero")));const N=document.querySelectorAll(".changeToSectionCards");N.forEach(e=>e.addEventListener("click",t=>m("sectionCards")));const k=document.querySelectorAll(".changeToFavorites");k.forEach(e=>e.addEventListener("click",t=>{w()}));y().then(e=>{}).catch(e=>console.log("Error: "+e));function w(){y().then(e=>{S(e),m("sectionCards"),x()}).catch(e=>console.log("Error: "+e))}function x(){document.querySelectorAll(".starFavoriteButtonContainer").forEach(o=>{const n=o.querySelector(".starFavoriteButton").getAttribute("data-id");o.innerHTML=`<a class="deleteFavoriteButton" data-id=${n}>
                                <i class="fa-solid fa-trash deleteFavorite"></i>
                            </a>`}),document.querySelectorAll(".deleteFavoriteButton").forEach(o=>o.addEventListener("click",n=>{const c=o.getAttribute("data-id");C(c).then(r=>{console.log(`Card with id ${c} has benn deleted from favorites.`),w()}).catch(r=>console.log("Error: "+r))}))}
